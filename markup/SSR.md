# 互动测验系统需求规格说明书（SSR，2025年6月最新版）

## 1. 项目背景与目标
- 实现现代化、可扩展的前端互动测验系统，支持多题型、题库切换、解析展示、成绩统计、无障碍与响应式设计。
- 适合自主练习、课堂自测、在线考试等多场景，支持自定义题库JSON文件，便于扩展和维护。

## 2. 技术架构与目录结构
- 纯前端实现，核心文件均在 `public/` 目录下，题库为标准JSON，支持多题库自动识别与切换。
- 主要目录结构如下：
  ```
  quiz/
  ├── public/
  │   ├── index.html
  │   ├── script.js
  │   ├── style.css
  │   └── lib/
  │       ├── quiz_data_Example.json
  │       └── quiz_English_data.json
  ├── images/
  ├── server.js
  └── readme.md
  ```

## 3. 题库数据格式（JSON）
- 每个题库为独立JSON文件，结构如下：
  ```json
  {
    "title": "题库名称",
    "questions": [
      {
        "id": 1,
        "type": "题目分类",
        "questionType": "single-choice|multi-choice|fill-in-blank|matching|true-false|...",
        "title": "题目标题",
        "content": "题干内容",
        "mediaType": "video|image|audio", // 可选
        "mediaUrl": "https://...",        // 可选
        "options": [ ... ]                // 结构随题型变化
      }
      // ...更多题目
    ]
  }
  ```
- 题型支持：单选、多选、填空、判断、连线、多媒体题等，详见 `public/lib/quiz_data_Example.json`。
- options 字段结构随题型变化，支持丰富的子题、选项、答案、解析等。

## 4. 前端页面与交互细节
### 4.1 题号导航栏（quiz-nav）UI/UX
- 导航栏位于左侧侧边栏，采用深色背景，宽度380px，固定布局。
- 每个题号为独立块（li），样式：
  - 字体大（1.25em）、行间距大、margin-bottom: 15px，padding: 12px 15px，圆角8px。
  - 题号与题目标题分两行显示，标题下方为分数/正确率（如“100% (3/3)”），分隔用div，间距可控。
  - 分数显示采用不同颜色：高分（≥90%）绿色，及格（60-89%）橙色，低分（<60%）红色。
  - 当前题高亮（绿色背景），已答题灰色，已批改题块有“completed-correct/completed-incorrect/completed-unanswered”类，背景色/字体色区分。
  - 支持题目标题tooltip，长标题自动换行。
- 响应式：窄屏下自动收起侧边栏，主内容区自适应。
- 可通过点击题号跳转，set模式下支持答题进度标记（已答/未答）。

### 4.2 综合评价与分数段描述
- 交卷后，综合评价区展示本次得分、分数段描述和emoji表情。
- 分数段与描述示例：
  - 100% 🥇 天才！你是卷王之王！妈妈再也不用担心我的学习了！
  - 90-99% 😎 优秀！快去领奖学金！
  - 80-89% 🙂 很棒，继续努力！
  - 60-79% 😅 及格线保卫战，差点就上岸！
  - 30-59% 🤔 需要加油，知识点要多复习！
  - 0-29% 🥲 这分数有点离谱，建议重做！
- 支持emoji、换行、幽默风格，分数段与样式可自定义。
- 分数区块采用大号字体、色彩区分，视觉突出。

### 4.3 单题模式“重新作答”机制
- 单题模式下，点击“重新作答”会：
  - 重置当前题目的分数显示、状态变量（如quizStarted/quizSubmitted/userAnswers等）。
  - 清除选项高亮、禁用状态，重新启用所有选项（调用 enableOptions()）。
  - 分数与正确率归零，分数区块样式恢复初始。
  - 导航栏对应题号分数/状态也同步重置。
- 彻底解决“重新作答后正确率未重置、选项无法点击”的bug。

### 4.4 题库切换与类型筛选
- 支持多题库自动识别，题库下拉菜单自动加载 `public/lib/` 下所有JSON。
- 支持题型筛选（如单选/多选/填空/连线/判断等），下拉菜单自动生成所有题型选项。
- 切换题库/题型后，导航栏与主内容区自动刷新。

### 4.5 题型与交互支持
- 单选、多选、判断：支持选项高亮、批改、解析、正确/错误标记。
- 填空题：支持多空、输入校验、答案与解析展示。
- 连线题：支持拖拽匹配、动态高亮、批改与解析。
- 多媒体题：支持视频/图片/音频嵌入，自动适配播放器。
- 所有题型均支持解析（explanation）、用户答案与正确答案对比、分数统计。

### 4.6 分数与状态标记
- 每题批改后，导航栏题号下方显示分数/正确率（如“80% (4/5)”），并根据分数段着色。
- set模式下，已答题块有“answered”类，已批改题块有“completed-correct/completed-incorrect/completed-unanswered”类。
- 主内容区分数显示同步更新，分数区块有“score-high/score-mid/score-low”类，绿色/橙色/红色区分。

### 4.7 无障碍与响应式优化
- 所有按钮、下拉菜单、题号等均有aria-label/title，Tab可达，键盘友好。
- 侧边栏、主内容区、选项、分数区块等均自适应布局，兼容桌面与移动端。
- 滚动条样式兼容主流浏览器，Firefox/Chrome/Safari均有优化。

### 4.8 主要前端逻辑说明
- `script.js` 负责题库加载、题型筛选、作答、批改、解析、题库切换等全部交互。
- 支持所有主流题型，自动适配题库结构。
- 支持多题库切换、题型筛选、成绩统计、解析展示等。
- 题库扩展仅需新增JSON文件，无需修改JS代码。

## 5. 题库扩展与维护建议
- 题库JSON结构清晰，强烈建议自定义制作，字段齐全、无注释、title必填。
- 新增题库只需放入 `public/lib/`，前端自动识别。
- 支持多题型混合，解析字段建议每题必填，多媒体题需填写mediaType/mediaUrl。
- 可参考 `public/lib/quiz_data_Example.json`、`quiz_English_data.json`。

## 6. 典型用户流程
1. 打开 `public/index.html`，选择题库与题型。
2. 点击“开始作答”，计时启动，作答各题。
3. 交卷后自动批改、分色显示正确率、展示解析与综合评价。
4. 可重新作答、切换题库/题型继续练习。

## 7. 未来扩展建议
- 支持后端API、用户系统、成绩分析、错题本、题型扩展等。
- 代码结构清晰，便于二次开发和开源协作。

---

如需插入完整代码片段、题库模板或页面截图，可补充于相应章节。
